<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>Question Sorter</title>
<style>
  :root{
    --bg:#f6fbff;
    --ink:#16324f;
    --accent:#2fbf71;
    --bad:#ff5c5c;
    --gold:#ffbf3f;
    --sky:#7dd3fc;
    --panel:#ffffff;
    --shadow:0 10px 20px rgba(0,0,0,.12);
  }
  *{box-sizing:border-box; user-select: none; /* Prevent text selection on controls */}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#eaf6ff); overflow: hidden;}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;color:var(--ink);display:flex;flex-direction:column}

  header{
    padding:.75rem 1rem;
    display:grid;
    grid-template-columns:1fr 1fr;
    grid-template-areas: "settings actions" "hud hud";
    align-items:center;
    gap:.5rem 1rem;
  }
  .title{
    font-weight:800; letter-spacing:.3px;
    text-transform:uppercase; font-size:clamp(.9rem,2.2vw,1rem);
  }
  .settings-container {
    grid-area: settings;
    display: flex;
    justify-self: start;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
  }
  .lang-switcher, .difficulty-switcher {
    display: flex;
    gap: .5rem;
    align-items: center;
    background: #eaf6ff;
    padding: .25rem;
    border-radius: 10px;
  }
  .lang-btn, .diff-btn {
    appearance: none; border: 2px solid transparent; background: transparent;
    border-radius: 8px; padding: .3rem .6rem;
    font-weight: 700; color: var(--ink); opacity: .7;
    cursor: pointer;
    transition: all .2s;
  }
  .lang-btn.active, .diff-btn.active {
    background: #fff;
    border-color: var(--sky);
    opacity: 1;
    box-shadow: 0 2px 5px rgba(0,0,0,.08);
  }
  .hud{
    grid-area: hud;
    display:flex; gap:12px; align-items:center; justify-content:center;
    background:var(--panel); padding:.5rem .75rem; border-radius:999px; box-shadow:var(--shadow);
  }
  .hud span{display:inline-flex; align-items:center; gap:.35rem; font-weight:700}
  .header-actions {
    grid-area: actions;
    text-align:right;
  }
  .btn{
    appearance:none; border:0; border-radius:10px; padding:.6rem .9rem;
    font-weight:800; background:var(--accent); color:#fff; box-shadow:var(--shadow); cursor:pointer;
  }
  .btn.secondary{background:#6b7b8d}
  .btn:active{transform:translateY(1px)}

  /* Game stage */
  .stage-wrap{
    flex:1; display:flex; justify-content:center; align-items:center; padding:10px;
    min-height: 0; /* Allow flex item to shrink properly */
  }
  .stage{
    position:relative; width:min(100vw,900px); height:100%;
    background:linear-gradient(180deg,#dff4ff 0 65%, #c2f0c2 65%); border-radius:16px;
    overflow:hidden; box-shadow:var(--shadow);
  }
  .ground{
    position:absolute; left:0; right:0; bottom:0; height:35%;
    background:
      radial-gradient(20px 12px at 20% 40%, rgba(255,255,255,.5), transparent 60%),
      radial-gradient(24px 14px at 60% 70%, rgba(255,255,255,.5), transparent 60%),
      linear-gradient(0deg,#9be49b,#b8f1b8 50%, #c7f6c7 100%);
  }

  /* Bins */
  .bin{
    position:absolute; bottom:8%; width:130px; height:110px; border-radius:14px;
    display:flex; align-items:center; justify-content:center; color:#fff; font-weight:900;
    text-align:center; padding:.5rem;
    box-shadow:0 8px 16px rgba(0,0,0,.18), inset 0 -10px 0 rgba(0,0,0,.08);
  }
  .bin.good{left:4%; background:linear-gradient(180deg,#2fd37b,#20b466)}
  .bin.bad{right:4%; background:linear-gradient(180deg,#ff6a6a,#e94545)}
  .bin .icon{font-size:1.5rem; display:block; opacity:.95}

  /* Player */
  .player{
    position:absolute; bottom:30%; left:0; transform:translateX(var(--px, 45%)); width:64px; height:96px;
  }
  .p-body{ position:absolute; inset:0; transform:translateZ(0); }
  .p-head{ width:42px; height:42px; border-radius:50%; background:#ffd8b1; position:absolute; left:11px; top:0; box-shadow:inset 0 -6px 0 rgba(0,0,0,.08); }
  .p-face::before,.p-face::after{ content:""; position:absolute; top:16px; width:6px; height:6px; border-radius:50%; background:#263238; }
  .p-face::before{left:14px} .p-face::after{right:14px}
  .p-smile{ position:absolute; top:27px; left:16px; width:10px; height:6px; border-bottom:3px solid #263238; border-radius:0 0 10px 10px; }
  .p-torso{ position:absolute; top:38px; left:6px; width:52px; height:40px; border-radius:10px; background:linear-gradient(180deg,#3b82f6,#2563eb); }
  .p-hand{ position:absolute; top:42px; width:14px; height:34px; border-radius:10px; background:#ffd8b1; }
  .p-hand.left{left:-4px} .p-hand.right{right:-4px}
  .p-legs{ position:absolute; top:74px; left:10px; width:44px; height:24px; display:flex; gap:6px; }
  .p-leg{flex:1; background:linear-gradient(180deg,#0f172a,#1f2937); border-radius:6px}
  .carry .p-hand.right{transform:translateY(-4px)}

  /* Question bubble */
  .question{
    position:absolute; min-width:180px; max-width:280px; padding:.6rem .7rem; border-radius:14px;
    background:var(--panel); box-shadow:var(--shadow); border:2px solid #e5f0ff;
    line-height:1.25; font-weight:600;
    transition: border-color .2s, box-shadow .2s;
  }
  .question.highlight { border-color: var(--gold); box-shadow: 0 0 15px rgba(255, 191, 63, 0.7); }
  .question::after{ content:""; position:absolute; bottom:-10px; left:24px; width:18px; height:18px; background:var(--panel); border-left:2px solid #e5f0ff; border-bottom:2px solid #e5f0ff; transform:rotate(-45deg); }
  .tag{ display:inline-block; margin-top:.35rem; font-size:.75rem; font-weight:800; padding:.1rem .45rem; border-radius:999px; }
  .neutraltag{background:#f3f4f6; color:#4b5563; border:1px solid #d1d5db;}

  /* --- NEW CONTROLS --- */
  .controls-overlay{
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 5%; /* Remove vertical padding */
    margin-bottom: 8vh; /* Add bottom margin to lift controls higher */
    width: 100%;
  }
  .action-button, .joystick {
    width: 120px;
    height: 120px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .action-button button {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: none;
    background: var(--panel);
    box-shadow: var(--shadow);
    font-size: 2rem;
    cursor: pointer;
  }
  .action-button button:active {
    transform: scale(0.95);
  }
  .joystick {
    position: relative;
    background-color: rgba(255,255,255,0.3);
    border-radius: 50%;
  }
  .joystick-knob {
    width: 60px;
    height: 60px;
    background-color: white;
    border-radius: 50%;
    position: absolute;
    box-shadow: 0 4px 10px rgba(0,0,0,.2);
    transition: transform 0.1s ease-out;
  }

  /* Toast / feedback */
  .toast{ position:absolute; top:10px; left:50%; transform:translateX(-50%); background:#000; color:#fff; padding:.45rem .7rem; border-radius:999px; opacity:0; pointer-events:none; transition:opacity .25s; }
  .toast.show{opacity:.8}

  /* Overlay screens */
  .overlay{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(10,20,30,.5); z-index: 100; }
  .card{ background:#fff; border-radius:16px; padding:1.2rem 1.5rem; width:min(92vw,520px); box-shadow:var(--shadow); text-align:center; }
  .card h2{margin:.2rem 0 1rem 0}
  .statrow{display:flex; gap:10px; justify-content:center; margin:.5rem 0 1rem 0; flex-wrap:wrap;}
  .stat{background:#f6f9ff; padding:.5rem .8rem; border-radius:10px; font-weight:800}
  .small{font-weight:600; color:#41556b}
  .kbr{font-size:.9rem; opacity:.8}

  .start-settings { margin: 1.5rem 0; display: flex; flex-direction: column; gap: 1rem; }
  .setting-row { display: flex; justify-content: space-between; align-items: center; gap: 1rem; text-align: left; }
  .setting-row label { font-weight: 700; font-size:1.1rem; }
  #startGameBtn { padding: .8rem 1.5rem; font-size: 1.2rem; margin-top: 1rem; width: 100%; }
  #modal { display: none; } /* Hide end-game modal by default */


  /* --- OPTIMIZATIONS FOR TABLET LANDSCAPE --- */
  @media screen and (min-width: 768px) and (orientation: landscape) {
    header {
        grid-template-columns: auto 1fr auto;
        grid-template-areas: "settings hud actions";
        padding: .75rem 1.5rem;
    }
    .hud {
        justify-content: center;
    }
    .stage {
        width: min(100vw, 1100px); /* Allow it to be a bit wider */
    }
    .question {
        font-size: 1.1rem; /* Slightly larger text on bigger screen */
    }
    .card {
        width: min(90vw, 600px); /* Larger modals */
        padding: 1.5rem 2rem;
    }
  }
  
  /* --- OPTIMIZATIONS FOR PORTRAIT MODE --- */
  @media screen and (orientation: portrait) {
    .controls-overlay {
        padding: 0 5%;
        margin-bottom: 6vh; /* Adjust margin for portrait */
    }
    .action-button, .joystick {
        width: 100px; /* smaller controls */
        height: 100px;
    }
    .action-button button {
        width: 70px;
        height: 70px;
    }
    .joystick-knob {
        width: 50px;
        height: 50px;
    }
    .bin {
        width: 110px; /* smaller bins */
        height: 100px;
        font-size: 0.9rem;
    }
    .bin .icon {
        font-size: 1.3rem;
    }
  }
</style>
</head>
<body>
  <header>
    <div class="settings-container">
      <div class="lang-switcher" id="headerLangSwitcher">
        <button class="lang-btn active" data-lang="en">EN</button>
        <button class="lang-btn" data-lang="tr">TR</button>
        <button class="lang-btn" data-lang="zh">ä¸­æ–‡</button>
      </div>
      <div class="difficulty-switcher" id="headerDiffSwitcher">
        <button class="diff-btn" data-difficulty="easy" data-key="easy">Easy</button>
        <button class="diff-btn active" data-difficulty="medium" data-key="medium">Medium</button>
        <button class="diff-btn" data-difficulty="hard" data-key="hard">Hard</button>
      </div>
    </div>
    <div class="hud" aria-live="polite">
      <span>â±ï¸ <b id="time">50</b>s</span>
      <span><span data-key="scoreLabel">Score</span> <b id="score">0</b></span>
      <span><span data-key="streakLabel">Streak</span> <b id="streak">0</b></span>
    </div>
    <div class="header-actions">
      <button class="btn secondary" id="howtoBtn" data-key="howToPlay" aria-haspopup="dialog">How to Play</button>
      <button class="btn" id="restartBtn" data-key="restart">Restart</button>
    </div>
  </header>

  <div class="stage-wrap">
    <div class="stage" id="stage" role="application" aria-label="Game stage">
      <div class="ground"></div>
      <div class="bin good" id="binGood" aria-label="Good Question Bin">
        <div><div class="icon">âœ…</div><span data-key="goodBin">Good<br/>Question</span></div>
      </div>
      <div class="bin bad" id="binBad" aria-label="Needs Work Bin">
        <div><div class="icon">âŒ</div><span data-key="badBin">Needs<br/>Work</span></div>
      </div>
      <div class="player" id="player" aria-label="Player">
        <div class="p-body">
          <div class="p-head"><div class="p-face"></div><div class="p-smile"></div></div>
          <div class="p-torso"></div><div class="p-hand left"></div><div class="p-hand right"></div>
          <div class="p-legs"><div class="p-leg"></div><div class="p-leg"></div></div>
        </div>
      </div>
      <div class="toast" id="toast" role="status"></div>
    </div>
  </div>

  <div class="controls-overlay" aria-label="Controls">
    <div class="action-button">
        <button id="pickupBtn" aria-label="Pick up or drop"><span data-key="pickupEmoji">ğŸ‘</span></button>
    </div>
    <div class="joystick" id="joystick">
        <div class="joystick-knob" id="joystickKnob"></div>
    </div>
  </div>

  <!-- Start Screen Modal -->
  <div class="overlay" id="startScreen" role="dialog" aria-modal="true" aria-labelledby="startTitle">
    <div class="card">
        <h2 id="startTitle" data-key="gameTitle">Question Sorter</h2>
        <div class="start-settings">
            <div class="setting-row">
                <label data-key="languageLabel">Language</label>
                <div class="lang-switcher" id="startLangSwitcher">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="tr">TR</button>
                    <button class="lang-btn" data-lang="zh">ä¸­æ–‡</button>
                </div>
            </div>
            <div class="setting-row">
                <label data-key="difficultyLabel">Difficulty</label>
                <div class="difficulty-switcher" id="startDiffSwitcher">
                     <button class="diff-btn" data-difficulty="easy" data-key="easy">Easy</button>
                     <button class="diff-btn active" data-difficulty="medium" data-key="medium">Medium</button>
                     <button class="diff-btn" data-difficulty="hard" data-key="hard">Hard</button>
                </div>
            </div>
        </div>
        <button class="btn" id="startGameBtn" data-key="startGame">Start Game</button>
    </div>
  </div>

  <!-- End Game/Info Modal -->
  <div class="overlay" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="card">
      <h2 id="modalTitle"></h2>
      <div id="modalContent"></div>
      <button class="btn" id="modalBtn"></button>
    </div>
  </div>

<script>
(()=> {
  // --- Questions (truncated for brevity) ---
  const allQuestions = {
    en: {
      easy: { good: ["What color is the sky on a clear day?", "How many legs does a spider have?", "What sound does a cow make?", "What is the capital of France?", "What do plants need to grow?", "What is 2 + 2?", "Which planet is known as the Red Planet?", "What is the main ingredient in bread?", "What do you use to write on a blackboard?", "Which animal is known as 'man's best friend'?"], weak: ["Blue?", "Pizza.", "Is it fast?", "Table.", "Running.", "Happy.", "Book.", "Why?", "Is it big?", "Yes."] },
      medium: { good: ["How does photosynthesis work?", "What are the three main states of matter?", "Why is it important to recycle?", "What is the difference between a city and a town?", "Explain the water cycle.", "How do vaccines protect us from diseases?", "What are the benefits of a balanced diet?", "Why do we have different seasons?", "What causes an earthquake?", "How has the internet changed communication?"], weak: ["What about science?", "Is history important?", "Explain everything.", "Are computers good?", "Tell me about weather.", "Why sleep?", "Is reading beneficial?", "Food is nice.", "Space.", "Thoughts on politics."] },
      hard: { good: ["Analyze the main causes of the Industrial Revolution.", "What are the ethical implications of artificial intelligence?", "Explain the concept of supply and demand in economics.", "How does the greenhouse effect contribute to climate change?", "What is the significance of the Magna Carta in legal history?", "Compare and contrast the political systems of two different countries.", "What are the challenges of space exploration?", "How does DNA replication work?", "Discuss the impact of globalization on local cultures.", "What is quantum computing and how might it change technology?"], weak: ["Is philosophy real?", "Why is the economy?", "Can science solve all problems?", "What is the meaning of it all?", "Is progress always good?", "Are humans logical?", "Tell me the future.", "Why do we exist?", "Is art objective?", "The universe is big."] }
    },
    tr: {
      easy: { good: ["AÃ§Ä±k bir gÃ¼nde gÃ¶kyÃ¼zÃ¼ ne renktir?", "Bir Ã¶rÃ¼mceÄŸin kaÃ§ bacaÄŸÄ± vardÄ±r?", "Ä°nek ne sesi Ã§Ä±karÄ±r?", "Fransa'nÄ±n baÅŸkenti neresidir?", "Bitkilerin bÃ¼yÃ¼mesi iÃ§in neye ihtiyacÄ± vardÄ±r?", "2 + 2 kaÃ§ eder?", "Hangi gezegen KÄ±zÄ±l Gezegen olarak bilinir?", "EkmeÄŸin ana maddesi nedir?", "Kara tahtaya yazÄ± yazmak iÃ§in ne kullanÄ±rsÄ±nÄ±z?", "Hangi hayvan 'insanÄ±n en iyi dostu' olarak bilinir?"], weak: ["Mavi mi?", "Pizza.", "HÄ±zlÄ± mÄ±?", "Masa.", "KoÅŸmak.", "Mutlu.", "Kitap.", "Neden?", "BÃ¼yÃ¼k mÃ¼?", "Evet."] },
      medium: { good: ["Fotosentez nasÄ±l Ã§alÄ±ÅŸÄ±r?", "Maddenin Ã¼Ã§ ana hali nedir?", "Geri dÃ¶nÃ¼ÅŸÃ¼m neden Ã¶nemlidir?", "Åehir ve kasaba arasÄ±ndaki fark nedir?", "Su dÃ¶ngÃ¼sÃ¼nÃ¼ aÃ§Ä±klayÄ±n.", "AÅŸÄ±lar bizi hastalÄ±klardan nasÄ±l korur?", "Dengeli beslenmenin faydalarÄ± nelerdir?", "Neden farklÄ± mevsimler yaÅŸarÄ±z?", "Depreme ne sebep olur?", "Ä°nternet iletiÅŸimi nasÄ±l deÄŸiÅŸtirdi?"], weak: ["Peki ya bilim?", "Tarih Ã¶nemli mi?", "Her ÅŸeyi aÃ§Ä±kla.", "Bilgisayarlar iyi mi?", "Bana havadan bahset.", "Neden uyuruz?", "Okumak faydalÄ± mÄ±?", "Yemek gÃ¼zeldir.", "Uzay.", "Siyaset Ã¼zerine dÃ¼ÅŸÃ¼nceler."] },
      hard: { good: ["Sanayi Devrimi'nin ana nedenlerini analiz edin.", "Yapay zekanÄ±n etik sonuÃ§larÄ± nelerdir?", "Ekonomide arz ve talep kavramÄ±nÄ± aÃ§Ä±klayÄ±n.", "Sera etkisi iklim deÄŸiÅŸikliÄŸine nasÄ±l katkÄ±da bulunur?", "Magna Carta'nÄ±n hukuk tarihindeki Ã¶nemi nedir?", "Ä°ki farklÄ± Ã¼lkenin siyasi sistemlerini karÅŸÄ±laÅŸtÄ±rÄ±n.", "Uzay araÅŸtÄ±rmalarÄ±nÄ±n zorluklarÄ± nelerdir?", "DNA replikasyonu nasÄ±l Ã§alÄ±ÅŸÄ±r?", "KÃ¼reselleÅŸmenin yerel kÃ¼ltÃ¼rler Ã¼zerindeki etkisini tartÄ±ÅŸÄ±n.", "Kuantum bilgisayar nedir ve teknolojiyi nasÄ±l deÄŸiÅŸtirebilir?"], weak: ["Felsefe gerÃ§ek mi?", "Ekonomi neden var?", "Bilim tÃ¼m sorunlarÄ± Ã§Ã¶zebilir mi?", "Her ÅŸeyin anlamÄ± ne?", "Ä°lerleme her zaman iyi midir?", "Ä°nsanlar mantÄ±klÄ± mÄ±dÄ±r?", "Bana geleceÄŸi sÃ¶yle.", "Neden varÄ±z?", "Sanat nesnel midir?", "Evren bÃ¼yÃ¼ktÃ¼r."] }
    },
    zh: {
      easy: { good: ["æ™´å¤©æ—¶å¤©ç©ºæ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼Ÿ", "èœ˜è››æœ‰å‡ æ¡è…¿ï¼Ÿ", "ç‰›å‘å‡ºä»€ä¹ˆå£°éŸ³ï¼Ÿ", "æ³•å›½çš„é¦–éƒ½æ˜¯å“ªé‡Œï¼Ÿ", "æ¤ç‰©ç”Ÿé•¿éœ€è¦ä»€ä¹ˆï¼Ÿ", "2 + 2 ç­‰äºå‡ ï¼Ÿ", "å“ªä¸ªè¡Œæ˜Ÿè¢«ç§°ä¸ºçº¢è‰²æ˜Ÿçƒï¼Ÿ", "é¢åŒ…çš„ä¸»è¦æˆåˆ†æ˜¯ä»€ä¹ˆï¼Ÿ", "ä½ ç”¨ä»€ä¹ˆåœ¨é»‘æ¿ä¸Šå†™å­—ï¼Ÿ", "å“ªç§åŠ¨ç‰©è¢«ç§°ä¸ºâ€œäººç±»æœ€å¥½çš„æœ‹å‹â€ï¼Ÿ"], weak: ["è“è‰²å—ï¼Ÿ", "æŠ«è¨ã€‚", "å®ƒå¿«å—ï¼Ÿ", "æ¡Œå­ã€‚", "è·‘æ­¥ã€‚", "å¼€å¿ƒã€‚", "ä¹¦ã€‚", "ä¸ºä»€ä¹ˆï¼Ÿ", "å®ƒå¤§å—ï¼Ÿ", "æ˜¯çš„ã€‚"] },
      medium: { good: ["å…‰åˆä½œç”¨æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Ÿ", "ç‰©è´¨çš„ä¸‰ç§ä¸»è¦çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Ÿ", "ä¸ºä»€ä¹ˆå›æ”¶å¾ˆé‡è¦ï¼Ÿ", "åŸå¸‚å’ŒåŸé•‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ", "è§£é‡Šä¸€ä¸‹æ°´å¾ªç¯ã€‚", "ç–«è‹—å¦‚ä½•ä¿æŠ¤æˆ‘ä»¬å…å—ç–¾ç—…ä¾µå®³ï¼Ÿ", "å‡è¡¡é¥®é£Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ", "æˆ‘ä»¬ä¸ºä»€ä¹ˆæœ‰ä¸åŒçš„å­£èŠ‚ï¼Ÿ", "æ˜¯ä»€ä¹ˆå¯¼è‡´äº†åœ°éœ‡ï¼Ÿ", "äº’è”ç½‘å¦‚ä½•æ”¹å˜äº†é€šè®¯ï¼Ÿ"], weak: ["ç§‘å­¦å‘¢ï¼Ÿ", "å†å²é‡è¦å—ï¼Ÿ", "è§£é‡Šä¸€åˆ‡ã€‚", "ç”µè„‘å¥½å—ï¼Ÿ", "è·Ÿæˆ‘è°ˆè°ˆå¤©æ°”ã€‚", "ä¸ºä»€ä¹ˆè¦ç¡è§‰ï¼Ÿ", "é˜…è¯»æœ‰ç›Šå—ï¼Ÿ", "é£Ÿç‰©å¾ˆå¥½ã€‚", "å¤ªç©ºã€‚", "å…³äºæ”¿æ²»çš„çœ‹æ³•ã€‚"] },
      hard: { good: ["åˆ†æå·¥ä¸šé©å‘½çš„ä¸»è¦åŸå› ã€‚", "äººå·¥æ™ºèƒ½çš„ä¼¦ç†å½±å“æ˜¯ä»€ä¹ˆï¼Ÿ", "è§£é‡Šç»æµå­¦ä¸­çš„ä¾›æ±‚æ¦‚å¿µã€‚", "æ¸©å®¤æ•ˆåº”å¦‚ä½•å¯¼è‡´æ°”å€™å˜åŒ–ï¼Ÿ", "ã€Šå¤§å®ªç« ã€‹åœ¨æ³•å¾‹å²ä¸Šçš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ", "æ¯”è¾ƒä¸¤ä¸ªä¸åŒå›½å®¶çš„æ”¿æ²»åˆ¶åº¦ã€‚", "å¤ªç©ºæ¢ç´¢çš„æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼Ÿ", "DNAå¤åˆ¶æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ", "è®¨è®ºå…¨çƒåŒ–å¯¹åœ°æ–¹æ–‡åŒ–çš„å½±å“ã€‚", "ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—ï¼Œå®ƒå¯èƒ½å¦‚ä½•æ”¹å˜æŠ€æœ¯ï¼Ÿ"], weak: ["å“²å­¦æ˜¯çœŸçš„å—ï¼Ÿ", "ç»æµä¸ºä»€ä¹ˆå­˜åœ¨ï¼Ÿ", "ç§‘å­¦èƒ½è§£å†³æ‰€æœ‰é—®é¢˜å—ï¼Ÿ", "è¿™ä¸€åˆ‡çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ", "è¿›æ­¥æ€»æ˜¯å¥½çš„å—ï¼Ÿ", "äººç±»æ˜¯ç†æ€§çš„å—ï¼Ÿ", "å‘Šè¯‰æˆ‘æœªæ¥ã€‚", "æˆ‘ä»¬ä¸ºä»€ä¹ˆå­˜åœ¨ï¼Ÿ", "è‰ºæœ¯æ˜¯å®¢è§‚çš„å—ï¼Ÿ", "å®‡å®™å¾ˆå¤§ã€‚"] }
    }
  };
  const translations = {
    en: { gameTitle: "Question Sorter", languageLabel: "Language", difficultyLabel: "Difficulty", startGame: "Start Game", scoreLabel: "Score", streakLabel: "Streak", howToPlay: "How to Play", restart: "Restart", goodBin: "Good<br/>Question", badBin: "Needs<br/>Work", pickupEmoji: "ğŸ‘", statement: "Statement", easy: "Easy", medium: "Medium", hard: "Hard", roundOver: "Round Over!", playAgain: "Play Again", howToPlayTitle: "How to Play", gotIt: "Got it!", toastNoQuestion: "No question nearby", toastMoveToPick: "Move onto the question to pick it up", toastCarrying: "Carrying questionâ€¦", toastStandOnBin: "Stand over a bin to drop", toastGreat: "Great job! âœ…", toastOops: "Oops â€” needs more work âŒ", toastMoveCloser: "Move closer to a question.", howToPlayContent: `<div style="text-align:left; line-height:1.5; margin-bottom:1rem;"><p>1) Use the <b>joystick</b> on the right to move.</p><p>2) Stand on a question and press the <b>action button</b> (ğŸ‘) on the left to grab it.</p><p>3) Carry it to the correct bin and press the button again to drop it.</p></div><p class="small">Score <b>+100</b> for correct sorts, <b>-50</b> for mistakes!</p>`, endRoundTip: `Use the joystick to move and the action button to pick/drop.`},
    tr: { gameTitle: "Soru AyÄ±klama", languageLabel: "Dil", difficultyLabel: "Zorluk", startGame: "Oyuna BaÅŸla", scoreLabel: "Puan", streakLabel: "Seri", howToPlay: "NasÄ±l OynanÄ±r", restart: "Yeniden BaÅŸlat", goodBin: "Ä°yi<br/>Soru", badBin: "GeliÅŸtirilmeli", pickupEmoji: "ğŸ‘", statement: "Ä°fade", easy: "Kolay", medium: "Orta", hard: "Zor", roundOver: "Tur Bitti!", playAgain: "Tekrar Oyna", howToPlayTitle: "NasÄ±l OynanÄ±r", gotIt: "AnladÄ±m!", toastNoQuestion: "YakÄ±nda soru yok", toastMoveToPick: "Almak iÃ§in sorunun Ã¼zerine gelin", toastCarrying: "Soru taÅŸÄ±nÄ±yor...", toastStandOnBin: "BÄ±rakmak iÃ§in bir kutunun Ã¼zerinde durun", toastGreat: "Harika iÅŸ! âœ…", toastOops: "Eyvah â€” geliÅŸtirilmeli âŒ", toastMoveCloser: "Bir soruya yaklaÅŸÄ±n.", howToPlayContent: `<div style="text-align:left; line-height:1.5; margin-bottom:1rem;"><p>1) Hareket etmek iÃ§in saÄŸdaki <b>kumanda kolunu</b> kullanÄ±n.</p><p>2) Bir sorunun Ã¼zerinde durun ve onu almak iÃ§in soldaki <b>eylem dÃ¼ÄŸmesine</b> (ğŸ‘) basÄ±n.</p><p>3) Onu doÄŸru kutuya taÅŸÄ±yÄ±n ve bÄ±rakmak iÃ§in dÃ¼ÄŸmeye tekrar basÄ±n.</p></div><p class="small">DoÄŸru sÄ±ralama iÃ§in <b>+100</b>, hatalar iÃ§in <b>-50</b> puan!</p>`, endRoundTip: `Hareket etmek iÃ§in kumanda kolunu, almak/bÄ±rakmak iÃ§in eylem dÃ¼ÄŸmesini kullanÄ±n.`},
    zh: { gameTitle: "é—®é¢˜åˆ†ç±»å™¨", languageLabel: "è¯­è¨€", difficultyLabel: "éš¾åº¦", startGame: "å¼€å§‹æ¸¸æˆ", scoreLabel: "åˆ†æ•°", streakLabel: "è¿èƒœ", howToPlay: "æ€ä¹ˆç©", restart: "é‡æ–°å¼€å§‹", goodBin: "å¥½é—®é¢˜", badBin: "å¾…æ”¹è¿›", pickupEmoji: "ğŸ‘", statement: "é™ˆè¿°", easy: "ç®€å•", medium: "ä¸­ç­‰", hard: "å›°éš¾", roundOver: "å›åˆç»“æŸ!", playAgain: "å†ç©ä¸€æ¬¡", howToPlayTitle: "æ€ä¹ˆç©", gotIt: "çŸ¥é“äº†!", toastNoQuestion: "é™„è¿‘æ²¡æœ‰é—®é¢˜", toastMoveToPick: "ç§»åŠ¨åˆ°é—®é¢˜ä¸Šæ‰èƒ½æ‹¾å–", toastCarrying: "æ­£åœ¨æ¬è¿é—®é¢˜...", toastStandOnBin: "ç«™åœ¨ç®±å­ä¸Šæ–¹æ”¾ä¸‹", toastGreat: "å¤ªæ£’äº†! âœ…", toastOops: "å“å‘€ â€” å¾…æ”¹è¿› âŒ", toastMoveCloser: "é è¿‘ä¸€ä¸ªé—®é¢˜ã€‚", howToPlayContent: `<div style="text-align:left; line-height:1.5; margin-bottom:1rem;"><p>1) ä½¿ç”¨å³ä¾§çš„<b>æ“çºµæ†</b>ç§»åŠ¨ã€‚</p><p>2) ç«™åœ¨é—®é¢˜ä¸Šï¼ŒæŒ‰å·¦ä¾§çš„<b>åŠ¨ä½œæŒ‰é’®</b> (ğŸ‘) æ¥æŠ“ä½å®ƒã€‚</p><p>3) å°†å…¶è¿åˆ°æ­£ç¡®çš„ç®±å­ï¼Œç„¶åå†æ¬¡æŒ‰æŒ‰é’®æ”¾ä¸‹å®ƒã€‚</p></div><p class="small">æ­£ç¡®åˆ†ç±»å¾—<b>+100</b>åˆ†ï¼Œé”™è¯¯åˆ†ç±»å¾—<b>-50</b>åˆ†ï¼</p>`, endRoundTip: `ä½¿ç”¨æ“çºµæ†ç§»åŠ¨ï¼Œä½¿ç”¨åŠ¨ä½œæŒ‰é’®æ‹¾å–/æ”¾ä¸‹ã€‚`}
  };

  let GOOD_QUESTIONS, WEAK_QUESTIONS;
  const stage = document.getElementById('stage');
  const playerEl = document.getElementById('player');
  const timeEl = document.getElementById('time');
  const scoreEl = document.getElementById('score');
  const streakEl = document.getElementById('streak');
  const toast = document.getElementById('toast');
  const pickupBtn= document.getElementById('pickupBtn');
  const restartBtn= document.getElementById('restartBtn');
  const howtoBtn= document.getElementById('howtoBtn');
  const startScreen = document.getElementById('startScreen');
  const startGameBtn = document.getElementById('startGameBtn');
  const modal = document.getElementById('modal');
  const modalTitle = document.getElementById('modalTitle');
  const modalContent = document.getElementById('modalContent');
  const modalBtn = document.getElementById('modalBtn');
  let modalBtnHandler = null;
  let stageRect;
  let px = 380, speed = 4.2, dir = 0;
  let carrying = false, carriedEl = null, carriedIsGood = false, highlightedQuestion = null;
  const pickupThreshold = 80;
  let currentLang = 'en';
  let currentDifficulty = 'medium';
  const TIME_LIMITS = { easy: 60, medium: 50, hard: 45 };
  let timeLeft = TIME_LIMITS[currentDifficulty];
  let score = 0, correct = 0, wrong = 0, streak = 0, topStreak = 0;
  let timerId = null;
  let roundOver = true;
  let gameStarted = false;
  let audioCtx = null;
  function beep(freq=900, dur=80, type='sine', vol=0.05){ try{ if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)(); const o = audioCtx.createOscillator(), g = audioCtx.createGain(); o.type = type; o.frequency.value = freq; g.gain.value = vol; o.connect(g); g.connect(audioCtx.destination); o.start(); setTimeout(()=>{o.stop()}, dur); }catch(e){ console.error("Could not play sound", e); }}
  function successSound(){ beep(880,90,'triangle',0.04); setTimeout(()=>beep(1200,90,'triangle',0.035),80); }
  function failSound(){ beep(220,130,'sawtooth',0.05); }
  function showToast(msgKey){ const msg = translations[currentLang][msgKey] || msgKey; toast.textContent = msg; toast.classList.add('show'); clearTimeout(showToast._t); showToast._t = setTimeout(()=>toast.classList.remove('show'), 700); }
  function rand(min,max){return Math.random()*(max-min)+min}
  function choose(arr){return arr[Math.floor(Math.random()*arr.length)]}
  function updateQuestionSource() { GOOD_QUESTIONS = allQuestions[currentLang][currentDifficulty].good; WEAK_QUESTIONS = allQuestions[currentLang][currentDifficulty].weak; }
  function setLanguage(lang) { if (!translations[lang]) return; currentLang = lang; updateQuestionSource(); document.querySelectorAll('[data-key]').forEach(el => { const key = el.dataset.key; if (translations[lang][key]) el.innerHTML = translations[lang][key]; }); document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.lang === lang)); if (gameStarted && !roundOver) spawnQuestion(); }
  function setDifficulty(difficulty) { if (!TIME_LIMITS[difficulty]) return; currentDifficulty = difficulty; updateQuestionSource(); document.querySelectorAll('.diff-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.difficulty === difficulty)); }
  function showInfoModal(titleKey, contentHTML, btnKey, btnAction) { modalTitle.textContent = translations[currentLang][titleKey] || titleKey; modalContent.innerHTML = contentHTML; modalBtn.textContent = translations[currentLang][btnKey] || btnKey; if (modalBtnHandler) modalBtn.removeEventListener('click', modalBtnHandler); modalBtnHandler = btnAction; modalBtn.addEventListener('click', modalBtnHandler); modal.style.display = 'flex'; }
  function hideInfoModal() { modal.style.display = 'none'; if (modalBtnHandler) modalBtn.removeEventListener('click', modalBtnHandler); }
  function layoutBins(){ stageRect = stage.getBoundingClientRect(); }
  function placePlayer(x=null){ if(x!==null) px = x; const maxX = stage.clientWidth - playerEl.clientWidth - 6; px = Math.max(6, Math.min(maxX, px)); playerEl.style.transform = `translateX(${px}px)`; }
  function spawnQuestion(){ [...stage.querySelectorAll('.question')].forEach(q=> { if(q !== carriedEl) q.remove(); }); const isGood = Math.random() < 0.5; const text = isGood ? choose(GOOD_QUESTIONS) : choose(WEAK_QUESTIONS); const q = document.createElement('div'); q.className = 'question'; q.setAttribute('role','note'); q.dataset.correct = isGood ? 'good' : 'bad'; q.innerHTML = `<div>${text}</div><span class="tag neutraltag">${translations[currentLang].statement}</span>`; const safeLeft = 160, safeRight = stage.clientWidth - 160 - 220; const x = Math.max(20, Math.min(stage.clientWidth-220, rand(safeLeft, safeRight))); q.style.left = `${x}px`; q.style.top = `${stage.clientHeight*0.30}px`; stage.appendChild(q); }
  function rect(el){ const r = el.getBoundingClientRect(); return { left: r.left - stageRect.left, right: r.right - stageRect.left, top: r.top - stageRect.top, bottom: r.bottom - stageRect.top, width: r.width, height: r.height }; }
  function overlap(a,b){ return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom); }
  function horizontalOverlap(a,b){ return !(a.right < b.left || a.left > b.right); }
  function playerRect(){ return rect(playerEl); }
  function nearestQuestion(){ const qs = [...stage.querySelectorAll('.question')]; if(!qs.length) return null; let best = null, bestDist = Infinity; const p = playerRect(); for(const q of qs){ const rr = rect(q); const cx = (rr.left+rr.right)/2; const pxCenter = (p.left+p.right)/2; const dist = Math.abs(cx - pxCenter); if(dist < bestDist){bestDist = dist; best = q;} } return {el: best, dist: bestDist}; }
  function pickOrDrop(){ if(roundOver) return; if(!carrying){ const qToPick = highlightedQuestion; if(!qToPick) { showToast("toastMoveCloser"); return; } carrying = true; carriedEl = qToPick; highlightedQuestion.classList.remove('highlight'); highlightedQuestion = null; carriedIsGood = (qToPick.dataset.correct === 'good'); playerEl.classList.add('carry'); qToPick.style.transition = 'transform .1s'; showToast("toastCarrying"); beep(700,80,'triangle',0.035); } else { const pr = playerRect(); const inGood = horizontalOverlap(pr, rect(document.getElementById('binGood'))); const inBad  = horizontalOverlap(pr, rect(document.getElementById('binBad'))); if(!inGood && !inBad){ showToast("toastStandOnBin"); return; } const droppedToGood = inGood; const correctDrop = (droppedToGood && carriedIsGood) || (!droppedToGood && !carriedIsGood); if(correctDrop){ score += 100; correct += 1; streak += 1; topStreak = Math.max(topStreak, streak); successSound(); playerCelebration(); showToast("toastGreat"); } else { score = Math.max(0, score - 50); wrong += 1; streak = 0; failSound(); showToast("toastOops"); } updateHUD(); if(carriedEl){carriedEl.remove(); carriedEl=null;} carrying = false; playerEl.classList.remove('carry'); spawnQuestion(); }}
  function playerCelebration(){ playerEl.style.transform = `translateX(${px}px) translateY(-6px)`; setTimeout(()=>{ playerEl.style.transform = `translateX(${px}px)`; }, 120); }
  function updateHUD(){ scoreEl.textContent = score; streakEl.textContent = streak; }
  function endRound(){ roundOver = true; clearInterval(timerId); const content = `<div class="statrow"><div class="stat">â­ ${translations[currentLang].scoreLabel}: <span>${score}</span></div><div class="stat">âœ… Correct: <span>${correct}</span></div><div class="stat">âŒ Mistakes: <span>${wrong}</span></div></div><p class="small">${translations[currentLang].streakLabel}: <b>${topStreak}</b></p><p class="kbr">${translations[currentLang].endRoundTip}</p>`; showInfoModal('roundOver', content, 'playAgain', showStartScreen); }
  function reset(){ hideInfoModal(); roundOver = false; timeLeft = TIME_LIMITS[currentDifficulty]; score = 0; correct = 0; wrong = 0; streak = 0; topStreak = 0; timeEl.textContent = timeLeft; updateHUD(); [...stage.querySelectorAll('.question')].forEach(q=>q.remove()); if(carrying && carriedEl) carriedEl.remove(); if(highlightedQuestion) highlightedQuestion.classList.remove('highlight'); highlightedQuestion = null; carrying = false; carriedEl=null; playerEl.classList.remove('carry'); layoutBins(); placePlayer(stage.clientWidth * 0.45); spawnQuestion(); }
  function showStartScreen() {
    hideInfoModal(); // Hide the end-game modal before showing the start screen
    startScreen.style.display = 'flex';
    roundOver = true;
    gameStarted = false;
    clearInterval(timerId);
    [...stage.querySelectorAll('.question')].forEach(q=>q.remove());
  }
  function startGame() { gameStarted = true; startScreen.style.display = 'none'; reset(); clearInterval(timerId); timerId = setInterval(()=>{ timeLeft -= 1; timeEl.textContent = timeLeft; if(timeLeft <= 0){ timeLeft = 0; endRound(); } }, 1000); }
  function loop(){ if(gameStarted && !roundOver){ if(dir !== 0){ px += dir*speed; placePlayer(); } if (highlightedQuestion) { highlightedQuestion.classList.remove('highlight'); highlightedQuestion = null; } if (!carrying) { const nearest = nearestQuestion(); if (nearest && nearest.el && nearest.dist < pickupThreshold) { highlightedQuestion = nearest.el; highlightedQuestion.classList.add('highlight'); } } if(carrying && carriedEl){ const offX = px + (playerEl.clientWidth/2) - (carriedEl.clientWidth/2); const offY = playerEl.offsetTop - carriedEl.clientHeight - 10; carriedEl.style.left = `${offX}px`; carriedEl.style.top  = `${offY}px`; } } requestAnimationFrame(loop); }
  
  function init() {
    pickupBtn.addEventListener('click', pickOrDrop);
    restartBtn.addEventListener('click', showStartScreen);
    howtoBtn.addEventListener('click', ()=>{ showInfoModal('howToPlayTitle', translations[currentLang].howToPlayContent, 'gotIt', hideInfoModal); });
    document.querySelectorAll('#startLangSwitcher .lang-btn, #headerLangSwitcher .lang-btn').forEach(btn => { btn.addEventListener('click', () => setLanguage(btn.dataset.lang)); });
    document.querySelectorAll('#startDiffSwitcher .diff-btn, #headerDiffSwitcher .diff-btn').forEach(btn => { btn.addEventListener('click', () => setDifficulty(btn.dataset.difficulty)); });
    startGameBtn.addEventListener('click', startGame);
    window.addEventListener('resize', ()=>{ layoutBins(); placePlayer(); });
    window.addEventListener('keydown',(e)=>{ if(e.key==='ArrowLeft') dir=-1; else if(e.key==='ArrowRight') dir=1; else if(e.key===' ' || e.key==='Spacebar'){ e.preventDefault(); pickOrDrop(); } });
    window.addEventListener('keyup',(e)=>{ if(e.key==='ArrowLeft' && dir<0) dir=0; if(e.key==='ArrowRight' && dir>0) dir=0; });
    
    // --- Joystick Logic ---
    const joystick = document.getElementById('joystick');
    const knob = document.getElementById('joystickKnob');
    let isDragging = false;
    let startX = 0;
    const maxMove = joystick.clientWidth / 2 - knob.clientWidth / 2;
    const deadZone = 10;

    function handleStart(e) {
      isDragging = true;
      const touch = e.touches ? e.touches[0] : e;
      startX = touch.clientX;
      knob.style.transition = 'none';
    }

    function handleMove(e) {
      if (!isDragging) return;
      e.preventDefault();
      const touch = e.touches ? e.touches[0] : e;
      let deltaX = touch.clientX - startX;
      
      if (deltaX > maxMove) deltaX = maxMove;
      if (deltaX < -maxMove) deltaX = -maxMove;
      
      knob.style.transform = `translateX(${deltaX}px)`;

      if (deltaX > deadZone) dir = 1;
      else if (deltaX < -deadZone) dir = -1;
      else dir = 0;
    }

    function handleEnd() {
      if (!isDragging) return;
      isDragging = false;
      dir = 0;
      knob.style.transition = 'transform 0.1s ease-out';
      knob.style.transform = 'translateX(0px)';
    }

    joystick.addEventListener('touchstart', handleStart, {passive: false});
    document.addEventListener('touchmove', handleMove, {passive: false});
    document.addEventListener('touchend', handleEnd);
    joystick.addEventListener('mousedown', handleStart);
    document.addEventListener('mousemove', handleMove);
    document.addEventListener('mouseup', handleEnd);
    document.addEventListener('mouseleave', handleEnd);

    layoutBins();
    placePlayer(stage.clientWidth * 0.45);
    setLanguage('en');
    setDifficulty('medium');
    showStartScreen();
    requestAnimationFrame(loop);
  }

  init();
})();
</script>
</body>
</html>




