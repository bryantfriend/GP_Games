<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beekeeper's Notes Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Patrick Hand', cursive;
            background-color: #f0f9ff;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23a7f3d0' fill-opacity='0.4'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h5v1h-5v9h5v1h-5v9h5v1h-5v9h5v1h-5v9h5v1h-5v9h5v1h-5v9h5v1h-5v9h5v1h-5v9h5v1H6v-1H0v-9h6v-1H0v-9h6v-1H0v-9h6v-1H0v-9h6v-1H0v-9h6v-1H0v-9h6v-1H0v-9h6v-1H0V5h6zm1 0h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h9V0h1v5h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1H7v-1H1v-9h6v-1H1v-9h6v-1H1v-9h6v-1H1v-9h6v-1H1v-9h6v-1H1v-9h6v-1H1v-9h6V5zm10 1h79v79H17V6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .bee {
            position: absolute;
            cursor: grab;
            transition: transform 0.2s ease-in-out;
            z-index: 10;
            display: flex;
            align-items: center;
            flex-direction: column;
            animation: buzz 3s ease-in-out infinite alternate;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .bee:active {
            cursor: grabbing;
        }
        
        @keyframes buzz {
            0% { transform: translateY(0px) rotate(-2deg); }
            50% { transform: translateY(-10px) rotate(0deg); }
            100% { transform: translateY(0px) rotate(2deg); }
        }

        .bee-body {
            width: 50px;
            height: 35px;
            background: linear-gradient(90deg, #FFD700 20%, #000 20%, #000 40%, #FFD700 40%, #FFD700 60%, #000 60%, #000 80%, #FFD700 80%);
            border-radius: 50% / 60%;
            position: relative;
        }

        .bee-body::before, .bee-body::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 30px;
            background-color: rgba(173, 216, 230, 0.7);
            border-radius: 50%;
            top: -15px;
        }

        .bee-body::before {
            left: 5px;
            transform: rotate(-30deg);
        }

        .bee-body::after {
            right: 5px;
            transform: rotate(30deg);
        }

        .note-paper {
            background-color: #fffacd;
            border: 1px solid #d2b48c;
            border-radius: 4px;
            padding: 2px 8px;
            margin-top: 4px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
            font-size: 1.1rem;
            white-space: nowrap;
        }
        
        .beehive {
            transition: all 0.3s ease;
            position: relative;
            max-width: 120px;
        }

        .beehive-label {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(139, 69, 19, 0.7);
            color: white;
            padding: 5px 15px;
            border-radius: 8px;
            font-size: clamp(0.75rem, 2.5vw, 1.25rem);
            width: 90%;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .drag-over {
            transform: scale(1.05);
            filter: brightness(1.1);
        }
        
        .correct-drop, .hint-reveal {
            animation: pulse-green 0.8s;
        }

        .incorrect-drop {
            animation: shake 0.5s;
        }

        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(74, 222, 128, 0); }
            100% { box-shadow: 0 0 0 0 rgba(74, 222, 128, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
    </style>
</head>
<body class="w-screen h-screen overflow-hidden text-slate-800 flex items-center justify-center">

    <!-- Main Menu -->
    <div id="main-menu" class="text-center">
        <h1 class="text-7xl text-amber-600 drop-shadow-lg mb-4">Beekeeper's Notes</h1>
        <h2 class="text-3xl text-slate-600 mb-8">Select a Language</h2>
        <div class="flex flex-col space-y-4">
            <button class="lang-btn bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition text-2xl" data-lang="en">English</button>
            <button class="lang-btn bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition text-2xl" data-lang="tr">T√ºrk√ße</button>
            <button class="lang-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition text-2xl" data-lang="zh">‰∏≠Êñá</button>
        </div>
    </div>
    
    <!-- Main Game Container -->
    <div id="game-container" class="hidden container mx-auto p-4 h-full flex flex-col">
        
        <!-- Header -->
        <header class="text-center mb-2 flex-shrink-0">
            <h1 id="game-title" class="text-5xl md:text-6xl text-amber-600 drop-shadow-lg">Beekeeper's Notes</h1>
            <p id="topic-display" class="text-2xl md:text-3xl text-slate-600 mt-1">Help the bees sort their notes!</p>
        </header>

        <!-- Top Bar with Stats and Upgrades -->
        <div class="flex-shrink-0 flex justify-between items-center bg-yellow-200/50 rounded-lg p-2 md:p-4 shadow-md mb-2 text-sm md:text-xl">
            <div class="flex items-center space-x-2">
                <span class="text-3xl">üçØ</span>
                <span id="honey-label">Honey:</span>
                <span id="honey-score" class="font-bold">0</span>
            </div>
            <div class="flex items-center gap-2 md:gap-4">
                 <div id="main-hive-visual" class="transition-transform duration-500" style="width: 50px; height: auto;">
                    <svg viewBox="0 0 100 100" class="w-full h-full drop-shadow-md">
                        <path id="hive-body" fill="#FFC107" d="M50 10 C 20 10, 10 30, 10 50 C 10 80, 20 90, 50 90 C 80 90, 90 80, 90 50 C 90 30, 80 10, 50 10 Z" />
                        <circle id="hive-door" fill="#A52A2A" cx="50" cy="75" r="8"/>
                        <g id="hive-roof" fill="#A52A2A"><path d="M50,2 A70,40 0,0,0 20,20 L 80,20 A70,40 0,0,0 50,2 Z" /></g>
                    </svg>
                 </div>
                <div class="flex flex-col gap-1">
                    <button id="upgrade-hive-button" class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-1 px-2 md:py-2 md:px-4 rounded-lg shadow-lg transition disabled:bg-gray-400 disabled:cursor-not-allowed text-xs md:text-base"></button>
                    <button id="upgrade-bonus-button" class="bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-2 md:py-2 md:px-4 rounded-lg shadow-lg transition disabled:bg-gray-400 disabled:cursor-not-allowed text-xs md:text-base"></button>
                    <button id="upgrade-hint-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-2 md:py-2 md:px-4 rounded-lg shadow-lg transition disabled:bg-gray-400 disabled:cursor-not-allowed text-xs md:text-base"></button>
                </div>
            </div>
            <div class="text-right">
                <span id="level-label">Level:</span>
                <span id="level-display" class="font-bold">1</span>
            </div>
        </div>

        <!-- Game Area: Bees and Hives now live here -->
        <main id="game-area" class="relative flex-grow flex flex-col border-4 border-dashed border-green-300 rounded-2xl bg-green-100/30 shadow-inner overflow-hidden">
             <!-- Bee Spawning Area -->
            <div id="bee-container" class="relative flex-grow">
                <!-- Bees will be dynamically added here -->
            </div>
            <!-- Beehives Area (now inside main) -->
            <div id="hives-area" class="flex justify-around items-end p-2 md:p-4 h-32 md:h-40 flex-shrink-0">
                <!-- Hives will be dynamically added here -->
            </div>
        </main>
    </div>

    <!-- Message Modal -->
    <div id="message-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div id="message-box" class="bg-white p-8 rounded-2xl shadow-2xl text-center text-4xl transform scale-50 opacity-0 transition-all duration-300">
            <p id="message-text"></p>
        </div>
    </div>


    <script>
        // DOM Elements
        const mainMenu = document.getElementById('main-menu');
        const gameContainer = document.getElementById('game-container');
        const langButtons = document.querySelectorAll('.lang-btn');

        const gameArea = document.getElementById('game-area');
        const beeContainer = document.getElementById('bee-container');
        const hivesArea = document.getElementById('hives-area');
        const honeyScoreEl = document.getElementById('honey-score');
        const levelDisplayEl = document.getElementById('level-display');
        const topicDisplayEl = document.getElementById('topic-display');
        const mainHiveVisual = document.getElementById('main-hive-visual');
        const messageModal = document.getElementById('message-modal');
        const messageBox = document.getElementById('message-box');
        const messageText = document.getElementById('message-text');

        // UI Text Elements
        const gameTitleEl = document.getElementById('game-title');
        const honeyLabelEl = document.getElementById('honey-label');
        const levelLabelEl = document.getElementById('level-label');
        const upgradeHiveBtn = document.getElementById('upgrade-hive-button');
        const upgradeBonusBtn = document.getElementById('upgrade-bonus-button');
        const upgradeHintBtn = document.getElementById('upgrade-hint-button');

        // Game State
        let honeyScore = 0;
        let currentLevelIndex = 0;
        let currentLanguage = 'en';
        let draggedBee = null; // For touch events
        
        // Upgrade State
        let hiveLevel = 1;
        let hiveUpgradeCost = 100;
        let bonusHoneyLevel = 0;
        let bonusHoneyCost = 150;
        let hintLevel = 0;
        let hintCost = 200;

        const translations = {
            en: {
                title: "Beekeeper's Notes",
                honey: "Honey:",
                level: "Level:",
                upgrade_hive: (cost) => `Upgrade Hive (${cost} üçØ)`,
                upgrade_bonus: (cost) => `Bonus Honey (${cost} üçØ)`,
                upgrade_hint: (cost) => `Reveal Hint (${cost} üçØ)`,
                level_complete: "Level Complete!",
                all_levels_complete: "You are a Master Beekeeper!",
                all_levels_complete_sub: "Congratulations! You've completed all the levels!",
                sweet: "Sweet!",
                wrong_hive: "Wrong hive!",
                hive_upgraded: "Hive Upgraded!",
                bonus_upgraded: "Bonus Upgraded!",
                hint_purchased: "Hint Revealed!",
                gameData: [
                    { topic: "Topic: Climate Change", categories: ["Causes", "Effects", "Solutions"], notes: [{ text: "Pollution", category: "Causes" }, { text: "Deforestation", category: "Causes" }, { text: "Fossil Fuels", category: "Causes" }, { text: "Rising Sea Levels", category: "Effects" }, { text: "Extreme Weather", category: "Effects" }, { text: "Melting Glaciers", category: "Effects" }, { text: "Renewable Energy", category: "Solutions" }, { text: "Recycling", category: "Solutions" }, { text: "Tree Planting", category: "Solutions" }] },
                    { topic: "Topic: Parts of a Plant", categories: ["Roots", "Stem", "Leaves"], notes: [{ text: "Absorb Water", category: "Roots" }, { text: "Anchor Plant", category: "Roots" }, { text: "Store Food", category: "Roots" }, { text: "Supports Plant", category: "Stem" }, { text: "Carries Water", category: "Stem" }, { text: "Holds up Leaves", category: "Stem" }, { text: "Photosynthesis", category: "Leaves" }, { text: "Makes Food", category: "Leaves" }, { text: "Gas Exchange", category: "Leaves" }] },
                    { topic: "Topic: Ancient Rome", categories: ["Government", "Architecture", "Daily Life"], notes: [{ text: "Republic", category: "Government" }, { text: "Senate", category: "Government" }, { text: "Emperors", category: "Government" }, { text: "Colosseum", category: "Architecture" }, { text: "Aqueducts", category: "Architecture" }, { text: "Roads", category: "Architecture" }, { text: "Togas", category: "Daily Life" }, { text: "Gladiator Games", category: "Daily Life" }, { text: "Public Baths", category: "Daily Life" }] },
                    { topic: "Topic: The Solar System", categories: ["Inner Planets", "Outer Planets", "Dwarf Planets"], notes: [{ text: "Mercury", category: "Inner Planets" }, { text: "Venus", category: "Inner Planets" }, { text: "Earth", category: "Inner Planets" }, { text: "Mars", category: "Inner Planets" }, { text: "Jupiter", category: "Outer Planets" }, { text: "Saturn", category: "Outer Planets" }, { text: "Uranus", category: "Outer Planets" }, { text: "Neptune", category: "Outer Planets" }, { text: "Pluto", category: "Dwarf Planets" }, { text: "Ceres", category: "Dwarf Planets" }] },
                    { topic: "Topic: Types of Rocks", categories: ["Igneous", "Sedimentary", "Metamorphic"], notes: [{ text: "Granite", category: "Igneous" }, { text: "Obsidian", category: "Igneous" }, { text: "Basalt", category: "Igneous" }, { text: "Sandstone", category: "Sedimentary" }, { text: "Limestone", category: "Sedimentary" }, { text: "Shale", category: "Sedimentary" }, { text: "Marble", category: "Metamorphic" }, { text: "Slate", category: "Metamorphic" }, { text: "Gneiss", category: "Metamorphic" }] }
                ]
            },
            tr: {
                title: "Arƒ±cƒ±nƒ±n Notlarƒ±",
                honey: "Bal:",
                level: "Seviye:",
                upgrade_hive: (cost) => `Kovanƒ± Geli≈ütir (${cost} üçØ)`,
                upgrade_bonus: (cost) => `Bonus Bal (${cost} üçØ)`,
                upgrade_hint: (cost) => `ƒ∞pucu G√∂ster (${cost} üçØ)`,
                level_complete: "Seviye Tamamlandƒ±!",
                all_levels_complete: "Usta Bir Arƒ±cƒ±sƒ±n!",
                all_levels_complete_sub: "Tebrikler! T√ºm seviyeleri tamamladƒ±n!",
                sweet: "Harika!",
                wrong_hive: "Yanlƒ±≈ü kovan!",
                hive_upgraded: "Kovan Geli≈ütirildi!",
                bonus_upgraded: "Bonus Geli≈ütirildi!",
                hint_purchased: "ƒ∞pucu Ortaya √áƒ±ktƒ±!",
                gameData: [
                    { topic: "Konu: ƒ∞klim Deƒüi≈üikliƒüi", categories: ["Nedenler", "Etkiler", "√á√∂z√ºmler"], notes: [{ text: "Kirlilik", category: "Nedenler" }, { text: "Ormansƒ±zla≈üma", category: "Nedenler" }, { text: "Fosil Yakƒ±tlar", category: "Nedenler" }, { text: "Y√ºkselen Deniz Seviyesi", category: "Etkiler" }, { text: "A≈üƒ±rƒ± Hava Ko≈üullarƒ±", category: "Etkiler" }, { text: "Buzullarƒ±n Erimesi", category: "Etkiler" }, { text: "Yenilenebilir Enerji", category: "√á√∂z√ºmler" }, { text: "Geri D√∂n√º≈ü√ºm", category: "√á√∂z√ºmler" }, { text: "Aƒüa√ß Dikimi", category: "√á√∂z√ºmler" }] },
                    { topic: "Konu: Bitkinin Kƒ±sƒ±mlarƒ±", categories: ["K√∂kler", "G√∂vde", "Yapraklar"], notes: [{ text: "Suyu Emer", category: "K√∂kler" }, { text: "Bitkiyi Sabitler", category: "K√∂kler" }, { text: "Besin Depolar", category: "K√∂kler" }, { text: "Bitkiyi Destekler", category: "G√∂vde" }, { text: "Su Ta≈üƒ±r", category: "G√∂vde" }, { text: "Yapraklarƒ± Tutar", category: "G√∂vde" }, { text: "Fotosentez", category: "Yapraklar" }, { text: "Besin Yapar", category: "Yapraklar" }, { text: "Gaz Alƒ±≈üveri≈üi", category: "Yapraklar" }] },
                    { topic: "Konu: Antik Roma", categories: ["Y√∂netim", "Mimari", "G√ºnl√ºk Ya≈üam"], notes: [{ text: "Cumhuriyet", category: "Y√∂netim" }, { text: "Senato", category: "Y√∂netim" }, { text: "ƒ∞mparatorlar", category: "Y√∂netim" }, { text: "Kolezyum", category: "Mimari" }, { text: "Su Kemerleri", category: "Mimari" }, { text: "Yollar", category: "Mimari" }, { text: "Togalar", category: "G√ºnl√ºk Ya≈üam" }, { text: "Gladyat√∂r Oyunlarƒ±", category: "G√ºnl√ºk Ya≈üam" }, { text: "Halk Hamamlarƒ±", category: "G√ºnl√ºk Ya≈üam" }] },
                    { topic: "Konu: G√ºne≈ü Sistemi", categories: ["ƒ∞√ß Gezegenler", "Dƒ±≈ü Gezegenler", "C√ºce Gezegenler"], notes: [{ text: "Merk√ºr", category: "ƒ∞√ß Gezegenler" }, { text: "Ven√ºs", category: "ƒ∞√ß Gezegenler" }, { text: "D√ºnya", category: "ƒ∞√ß Gezegenler" }, { text: "Mars", category: "ƒ∞√ß Gezegenler" }, { text: "J√ºpiter", category: "Dƒ±≈ü Gezegenler" }, { text: "Sat√ºrn", category: "Dƒ±≈ü Gezegenler" }, { text: "Uran√ºs", category: "Dƒ±≈ü Gezegenler" }, { text: "Nept√ºn", category: "Dƒ±≈ü Gezegenler" }, { text: "Pl√ºton", category: "C√ºce Gezegenler" }, { text: "Ceres", category: "C√ºce Gezegenler" }] },
                    { topic: "Konu: Kaya√ß T√ºrleri", categories: ["Magmatik", "Tortul", "Ba≈ükala≈üƒ±m"], notes: [{ text: "Granit", category: "Magmatik" }, { text: "Obsidiyen", category: "Magmatik" }, { text: "Bazalt", category: "Magmatik" }, { text: "Kumta≈üƒ±", category: "Tortul" }, { text: "Kire√ßta≈üƒ±", category: "Tortul" }, { text: "≈ûeyl", category: "Tortul" }, { text: "Mermer", category: "Ba≈ükala≈üƒ±m" }, { text: "Sleyt", category: "Ba≈ükala≈üƒ±m" }, { text: "Gnay", category: "Ba≈ükala≈üƒ±m" }] }
                ]
            },
            zh: {
                title: "ÂÖªËúÇ‰∫∫ÁöÑÁ¨îËÆ∞",
                honey: "ËúÇËúú:",
                level: "Á≠âÁ∫ß:",
                upgrade_hive: (cost) => `ÂçáÁ∫ßËúÇÁÆ± (${cost} üçØ)`,
                upgrade_bonus: (cost) => `Â•ñÂä±ËúÇËúú (${cost} üçØ)`,
                upgrade_hint: (cost) => `ÊòæÁ§∫ÊèêÁ§∫ (${cost} üçØ)`,
                level_complete: "ÂÆåÊàêÊú¨Á∫ßÔºÅ",
                all_levels_complete: "‰Ω†ÊòØ‰∏Ä‰ΩçÂÖªËúÇÂ§ßÂ∏àÔºÅ",
                all_levels_complete_sub: "ÊÅ≠ÂñúÔºÅ‰Ω†Â∑≤ÁªèÂÆåÊàê‰∫ÜÊâÄÊúâÂÖ≥Âç°ÔºÅ",
                sweet: "Â•ΩÁîúËúúÔºÅ",
                wrong_hive: "ÈîôËØØÁöÑËúÇÁÆ±ÔºÅ",
                hive_upgraded: "ËúÇÁÆ±Â∑≤ÂçáÁ∫ßÔºÅ",
                bonus_upgraded: "Â•ñÂä±Â∑≤ÂçáÁ∫ßÔºÅ",
                hint_purchased: "ÊèêÁ§∫Â∑≤ÊòæÁ§∫ÔºÅ",
                gameData: [
                    { topic: "‰∏ªÈ¢òÔºöÊ∞îÂÄôÂèòÂåñ", categories: ["ÂéüÂõ†", "ÂΩ±Âìç", "Ëß£ÂÜ≥ÊñπÊ°à"], notes: [{ text: "Ê±°Êüì", category: "ÂéüÂõ†" }, { text: "Á†ç‰ºêÊ£ÆÊûó", category: "ÂéüÂõ†" }, { text: "ÂåñÁü≥ÁáÉÊñô", category: "ÂéüÂõ†" }, { text: "Êµ∑Âπ≥Èù¢‰∏äÂçá", category: "ÂΩ±Âìç" }, { text: "ÊûÅÁ´ØÂ§©Ê∞î", category: "ÂΩ±Âìç" }, { text: "ÂÜ∞Â∑ùËûçÂåñ", category: "ÂΩ±Âìç" }, { text: "ÂèØÂÜçÁîüËÉΩÊ∫ê", category: "Ëß£ÂÜ≥ÊñπÊ°à" }, { text: "ÂõûÊî∂Âà©Áî®", category: "Ëß£ÂÜ≥ÊñπÊ°à" }, { text: "Ê§çÊ†ë", category: "Ëß£ÂÜ≥ÊñπÊ°à" }] },
                    { topic: "‰∏ªÈ¢òÔºöÊ§çÁâ©ÁöÑÂêÑÈÉ®ÂàÜ", categories: ["Ê†π", "Ëåé", "Âè∂"], notes: [{ text: "Âê∏Êî∂Ê∞¥ÂàÜ", category: "Ê†π" }, { text: "Âõ∫ÂÆöÊ§çÁâ©", category: "Ê†π" }, { text: "ÂÇ®Â≠òÈ£üÁâ©", category: "Ê†π" }, { text: "ÊîØÊíëÊ§çÁâ©", category: "Ëåé" }, { text: "ËøêËæìÊ∞¥ÂàÜ", category: "Ëåé" }, { text: "‰∏æËµ∑Âè∂Â≠ê", category: "Ëåé" }, { text: "ÂÖâÂêà‰ΩúÁî®", category: "Âè∂" }, { text: "Âà∂ÈÄ†È£üÁâ©", category: "Âè∂" }, { text: "Ê∞î‰Ωì‰∫§Êç¢", category: "Âè∂" }] },
                    { topic: "‰∏ªÈ¢òÔºöÂè§ÁΩóÈ©¨", categories: ["ÊîøÂ∫ú", "Âª∫Á≠ë", "Êó•Â∏∏ÁîüÊ¥ª"], notes: [{ text: "ÂÖ±ÂíåÂõΩ", category: "ÊîøÂ∫ú" }, { text: "ÂÖÉËÄÅÈô¢", category: "ÊîøÂ∫ú" }, { text: "ÁöáÂ∏ù", category: "ÊîøÂ∫ú" }, { text: "ÁΩóÈ©¨ÊñóÂÖΩÂú∫", category: "Âª∫Á≠ë" }, { text: "Ê∞¥ÈÅì", category: "Âª∫Á≠ë" }, { text: "ÈÅìË∑Ø", category: "Âª∫Á≠ë" }, { text: "ÊâòÂä†Ë¢ç", category: "Êó•Â∏∏ÁîüÊ¥ª" }, { text: "ËßíÊñóÂ£´ÊØîËµõ", category: "Êó•Â∏∏ÁîüÊ¥ª" }, { text: "ÂÖ¨ÂÖ±Êµ¥Âú∫", category: "Êó•Â∏∏ÁîüÊ¥ª" }] },
                    { topic: "‰∏ªÈ¢òÔºöÂ§™Èò≥Á≥ª", categories: ["ÂÜÖË°åÊòü", "Â§ñË°åÊòü", "ÁüÆË°åÊòü"], notes: [{ text: "Ê∞¥Êòü", category: "ÂÜÖË°åÊòü" }, { text: "ÈáëÊòü", category: "ÂÜÖË°åÊòü" }, { text: "Âú∞ÁêÉ", category: "ÂÜÖË°åÊòü" }, { text: "ÁÅ´Êòü", category: "ÂÜÖË°åÊòü" }, { text: "Êú®Êòü", category: "Â§ñË°åÊòü" }, { text: "ÂúüÊòü", category: "Â§ñË°åÊòü" }, { text: "Â§©ÁéãÊòü", category: "Â§ñË°åÊòü" }, { text: "Êµ∑ÁéãÊòü", category: "Â§ñË°åÊòü" }, { text: "ÂÜ•ÁéãÊòü", category: "ÁüÆË°åÊòü" }, { text: "Ë∞∑Á•ûÊòü", category: "ÁüÆË°åÊòü" }] },
                    { topic: "‰∏ªÈ¢òÔºöÂ≤©Áü≥ÁßçÁ±ª", categories: ["ÁÅ´ÊàêÂ≤©", "Ê≤âÁßØÂ≤©", "ÂèòË¥®Â≤©"], notes: [{ text: "Ëä±Â≤óÂ≤©", category: "ÁÅ´ÊàêÂ≤©" }, { text: "ÈªëÊõúÁü≥", category: "ÁÅ´ÊàêÂ≤©" }, { text: "ÁéÑÊ≠¶Â≤©", category: "ÁÅ´ÊàêÂ≤©" }, { text: "Á†ÇÂ≤©", category: "Ê≤âÁßØÂ≤©" }, { text: "Áü≥ÁÅ∞Â≤©", category: "Ê≤âÁßØÂ≤©" }, { text: "È°µÂ≤©", category: "Ê≤âÁßØÂ≤©" }, { text: "Â§ßÁêÜÁü≥", category: "ÂèòË¥®Â≤©" }, { text: "ÊùøÂ≤©", category: "ÂèòË¥®Â≤©" }, { text: "ÁâáÈ∫ªÂ≤©", category: "ÂèòË¥®Â≤©" }] }
                ]
            }
        };

        function startGame(lang) {
            currentLanguage = lang;
            mainMenu.classList.add('hidden');
            gameContainer.classList.remove('hidden');
            gameContainer.classList.add('flex');
            
            translateUI();
            loadLevel(currentLevelIndex);
            updateScore();

            upgradeHiveBtn.addEventListener('click', upgradeHive);
            upgradeBonusBtn.addEventListener('click', upgradeBonus);
            upgradeHintBtn.addEventListener('click', buyHint);
        }
        
        function translateUI() {
            const t = translations[currentLanguage];
            gameTitleEl.textContent = t.title;
            honeyLabelEl.textContent = t.honey;
            levelLabelEl.textContent = t.level;
            updateUpgradeButtons();
        }

        function updateUpgradeButtons() {
            const t = translations[currentLanguage];
            upgradeHiveBtn.textContent = t.upgrade_hive(hiveUpgradeCost);
            upgradeBonusBtn.textContent = t.upgrade_bonus(bonusHoneyCost);
            upgradeHintBtn.textContent = t.upgrade_hint(hintCost);

            upgradeHiveBtn.disabled = honeyScore < hiveUpgradeCost;
            upgradeBonusBtn.disabled = honeyScore < bonusHoneyCost;
            upgradeHintBtn.disabled = honeyScore < hintCost;
        }

        function loadLevel(levelIndex) {
            const levelData = translations[currentLanguage].gameData[levelIndex];
            if (!levelData) {
                const t = translations[currentLanguage];
                showMessage(t.all_levels_complete, "bg-green-400");
                topicDisplayEl.innerText = t.all_levels_complete_sub;
                beeContainer.innerHTML = '';
                hivesArea.innerHTML = '';
                return;
            }

            beeContainer.innerHTML = '';
            hivesArea.innerHTML = '';
            
            levelDisplayEl.textContent = levelIndex + 1;
            topicDisplayEl.textContent = levelData.topic;
            
            levelData.categories.forEach(category => {
                const hive = document.createElement('div');
                hive.className = 'beehive w-1/3 h-full relative flex-shrink-0';
                hive.dataset.category = category;
                hive.innerHTML = `<svg viewBox="0 0 100 100" class="w-full h-full drop-shadow-lg filter hover:brightness-105"><path fill="#FFC107" d="M50 20 C 20 20, 10 40, 10 60 C 10 90, 20 100, 50 100 C 80 100, 90 90, 90 60 C 90 40, 80 20, 50 20 Z" /><path fill="#A52A2A" d="M50,10 A60,50 0,0,0 20,35 L 80,35 A60,50 0,0,0 50,10 Z" /><circle fill="#654321" cx="50" cy="85" r="10"/></svg><div class="beehive-label">${category}</div>`;
                hivesArea.appendChild(hive);

                hive.addEventListener('dragover', e => { e.preventDefault(); hive.classList.add('drag-over'); });
                hive.addEventListener('dragleave', () => hive.classList.remove('drag-over'));
                hive.addEventListener('drop', handleDrop);
            });

            levelData.notes.forEach((note, index) => {
                const bee = document.createElement('div');
                bee.id = `bee-${index}`;
                bee.className = 'bee';
                bee.draggable = true;
                bee.dataset.category = note.category;
                bee.innerHTML = `<div class="bee-body"></div><div class="note-paper">${note.text}</div>`;

                setTimeout(() => {
                    const areaRect = beeContainer.getBoundingClientRect();
                    const beeWidth = 150; 
                    const beeHeight = 80;
                    if (areaRect.width > beeWidth && areaRect.height > beeHeight) {
                        bee.style.left = `${Math.random() * (areaRect.width - beeWidth)}px`;
                        bee.style.top = `${Math.random() * (areaRect.height - beeHeight)}px`;
                    }
                }, 0);
                
                beeContainer.appendChild(bee);
                bee.addEventListener('dragstart', handleDragStart);
                
                // Add touch events for tablets and mobile
                bee.addEventListener('touchstart', handleTouchStart, { passive: false });
                bee.addEventListener('touchmove', handleTouchMove, { passive: false });
                bee.addEventListener('touchend', handleTouchEnd);
            });
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.closest('.bee').id);
        }

        function handleDrop(e) {
            e.preventDefault();
            const hive = e.currentTarget;
            hive.classList.remove('drag-over');
            
            const beeId = e.dataTransfer.getData('text/plain');
            const bee = document.getElementById(beeId);
            
            processDrop(bee, hive);
        }

        // --- Touch Event Handlers ---
        function handleTouchStart(e) {
            e.preventDefault();
            draggedBee = e.currentTarget;
            draggedBee.style.zIndex = "1000";
            draggedBee.style.transform = "scale(1.1)";
        }

        function handleTouchMove(e) {
            e.preventDefault();
            if (!draggedBee) return;

            const touch = e.targetTouches[0];
            const gameAreaRect = gameArea.getBoundingClientRect();

            // Position the bee centered on the finger
            let x = touch.clientX - gameAreaRect.left - (draggedBee.offsetWidth / 2);
            let y = touch.clientY - gameAreaRect.top - (draggedBee.offsetHeight / 2);
            
            // Constrain to game area
            x = Math.max(0, Math.min(x, gameAreaRect.width - draggedBee.offsetWidth));
            y = Math.max(0, Math.min(y, gameAreaRect.height - draggedBee.offsetHeight));

            draggedBee.style.left = `${x}px`;
            draggedBee.style.top = `${y}px`;

            // Check for hive overlap
            const elementUnder = document.elementFromPoint(touch.clientX, touch.clientY);
            const hiveUnder = elementUnder ? elementUnder.closest('.beehive') : null;

            hivesArea.querySelectorAll('.beehive').forEach(hive => {
                if (hive === hiveUnder) {
                    hive.classList.add('drag-over');
                } else {
                    hive.classList.remove('drag-over');
                }
            });
        }

        function handleTouchEnd(e) {
            if (!draggedBee) return;

            draggedBee.style.zIndex = "10";
            draggedBee.style.transform = "scale(1)";

            const touch = e.changedTouches[0];
            const elementUnder = document.elementFromPoint(touch.clientX, touch.clientY);
            const hiveUnder = elementUnder ? elementUnder.closest('.beehive') : null;
            
            hivesArea.querySelectorAll('.beehive').forEach(hive => hive.classList.remove('drag-over'));

            if (hiveUnder) {
                processDrop(draggedBee, hiveUnder);
            }

            draggedBee = null;
        }

        function processDrop(bee, hive) {
            if (!bee || !hive) return;
            
            const beeCategory = bee.dataset.category;
            const hiveCategory = hive.dataset.category;
            const t = translations[currentLanguage];

            if (beeCategory === hiveCategory) {
                let honeyGained = 10;
                // Check for bonus honey
                if (Math.random() < bonusHoneyLevel * 0.1) { // 10% chance per level
                    honeyGained += 20;
                    showMessage("+20 Bonus!", "bg-yellow-400");
                }
                
                honeyScore += honeyGained;
                updateScore();
                bee.remove();
                hive.classList.add('correct-drop');
                setTimeout(() => hive.classList.remove('correct-drop'), 500);
                showMessage(t.sweet, "bg-green-400");
                checkLevelComplete();
            } else {
                hive.classList.add('incorrect-drop');
                setTimeout(() => hive.classList.remove('incorrect-drop'), 500);
                showMessage(t.wrong_hive, "bg-red-400");
            }
        }

        function checkLevelComplete() {
            if (beeContainer.childElementCount === 0) {
                const t = translations[currentLanguage];
                showMessage(t.level_complete, "bg-blue-400");
                currentLevelIndex++;
                setTimeout(() => loadLevel(currentLevelIndex), 1500);
            }
        }

        function updateScore() {
            honeyScoreEl.textContent = honeyScore;
            updateUpgradeButtons();
        }
        
        function upgradeHive() {
            if (honeyScore >= hiveUpgradeCost) {
                honeyScore -= hiveUpgradeCost;
                hiveLevel++;
                hiveUpgradeCost = Math.floor(hiveUpgradeCost * 1.8);
                updateScore();
                mainHiveVisual.style.transform = `scale(${1 + hiveLevel * 0.1})`;
                showMessage(translations[currentLanguage].hive_upgraded, "bg-yellow-400");
            }
        }

        function upgradeBonus() {
            if (honeyScore >= bonusHoneyCost) {
                honeyScore -= bonusHoneyCost;
                bonusHoneyLevel++;
                bonusHoneyCost = Math.floor(bonusHoneyCost * 2);
                updateScore();
                 showMessage(translations[currentLanguage].bonus_upgraded, "bg-green-400");
            }
        }

        function buyHint() {
            if (honeyScore >= hintCost && beeContainer.children.length > 0) {
                 honeyScore -= hintCost;
                 hintLevel++;
                 hintCost = Math.floor(hintCost * 1.5);
                 updateScore();

                 const firstBee = beeContainer.children[0];
                 const correctCategory = firstBee.dataset.category;
                 const correctHive = hivesArea.querySelector(`[data-category="${correctCategory}"]`);

                 correctHive.classList.add('hint-reveal');
                 setTimeout(() => correctHive.classList.remove('hint-reveal'), 800);
                 showMessage(translations[currentLanguage].hint_purchased, "bg-blue-400");
            }
        }


        function showMessage(msg, bgColor) {
            messageText.textContent = msg;
            messageBox.className = `bg-white p-8 rounded-2xl shadow-2xl text-center text-4xl transform scale-50 opacity-0 transition-all duration-300 ${bgColor} text-white`;

            messageModal.classList.remove('hidden');
            setTimeout(() => {
                messageBox.classList.remove('scale-50', 'opacity-0');
                messageBox.classList.add('scale-100', 'opacity-100');
            }, 10);
            
            setTimeout(() => {
                messageBox.classList.remove('scale-100', 'opacity-100');
                messageBox.classList.add('scale-50', 'opacity-0');
                setTimeout(() => messageModal.classList.add('hidden'), 300);
            }, 1200);
        }

        // Initialize the main menu
        window.onload = () => {
             langButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    startGame(e.target.dataset.lang);
                });
            });
        };
    </script>
</body>
</html>

